# üöÄ Quick Setup Guide

This guide will help you set up the project on a new computer after cloning.

## Prerequisites

Before you begin, make sure you have:
- ‚úÖ Python 3.11 or higher
- ‚úÖ PostgreSQL 15 or higher
- ‚úÖ Poetry (Python package manager)
- ‚úÖ Git

## Step-by-Step Setup

### 1Ô∏è‚É£ Clone the Repository

```bash
git clone https://github.com/hiren0158/book-management-api.git
cd book-management-api
```

### 2Ô∏è‚É£ Install Python Dependencies

```bash
# Install Poetry if you don't have it
curl -sSL https://install.python-poetry.org | python3 -

# Install project dependencies
poetry install
```

### 3Ô∏è‚É£ Set Up Environment Variables

```bash
# Copy the example environment file
cp .env.example .env
```

**Now edit the `.env` file and fill in your values:**

```bash
# Use your favorite editor
nano .env
# or
code .env
# or
vim .env
```

**Required values to change:**

1. **DATABASE_URL** - Your PostgreSQL connection string
   ```
   postgresql://your_username:your_password@localhost:5432/book_management
   ```

2. **JWT_SECRET_KEY** - Generate a secure random key
   ```bash
   # Generate a secure key
   openssl rand -hex 32
   ```
   Copy the output and paste it in .env

3. **JWT_REFRESH_SECRET_KEY** - Generate another secure key
   ```bash
   openssl rand -hex 32
   ```

4. **GEMINI_API_KEY** - Get your API key from [Google AI Studio](https://makersuite.google.com/app/apikey)

5. **RAG_API_KEY** - Use the same key as configured on HuggingFace Spaces:
   ```
   DCW3JOEMDl-SKRTFv8eMYoJUWl9FzJgB131w7dwDUw8
   ```
   (Or generate a new one if deploying your own RAG service)

### 4Ô∏è‚É£ Set Up the Database

#### Option A: Local PostgreSQL

```bash
# Create the database
createdb book_management

# Run database migrations
poetry run alembic upgrade head

# Initialize with default roles and data
poetry run python scripts/init_database.py
```

#### Option B: Using Docker

```bash
# Start PostgreSQL in Docker
docker-compose up -d postgres

# Wait a few seconds for PostgreSQL to start, then run migrations
poetry run alembic upgrade head
poetry run python scripts/init_database.py
```

### 5Ô∏è‚É£ Verify Setup

```bash
# Run tests to make sure everything works
poetry run pytest

# If all 186 tests pass, you're good! ‚úÖ
```

### 6Ô∏è‚É£ Start the Development Server

```bash
poetry run uvicorn main:app --reload
```

Visit:
- **API**: http://localhost:8000
- **Docs**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

---

## üîß Troubleshooting

### "Command not found: poetry"

Install Poetry:
```bash
curl -sSL https://install.python-poetry.org | python3 -
```

Add to PATH (add to your ~/.bashrc or ~/.zshrc):
```bash
export PATH="$HOME/.local/bin:$PATH"
```

### "Database connection failed"

1. Make sure PostgreSQL is running:
   ```bash
   # macOS:
   brew services start postgresql
   
   # Linux:
   sudo systemctl start postgresql
   
   # Check status:
   pg_isready
   ```

2. Verify your DATABASE_URL in `.env` is correct

3. Test connection:
   ```bash
   psql postgresql://username:password@localhost:5432/book_management
   ```

### "No module named 'httpx'" or similar

Reinstall dependencies:
```bash
poetry install --no-cache
```

### Tests failing

Make sure you've:
1. Set up all environment variables in `.env`
2. Run database migrations: `poetry run alembic upgrade head`
3. Have a clean test database

Run tests in verbose mode to see what's failing:
```bash
poetry run pytest -v --tb=short
```

---

## üìù What's NOT in Git (You Need to Create)

These files are **intentionally ignored** by Git for security:

### `.env` - Environment variables
- **Why ignored:** Contains secrets and API keys
- **How to create:** `cp .env.example .env` then edit with your values
- **Location:** Project root

### `chroma_db/` - Vector database
- **Why ignored:** Auto-generated by RAG service
- **How to create:** Automatically created when you upload PDFs
- **Location:** Project root (but RAG is now on HuggingFace)

### `models/` - ML model cache
- **Why ignored:** Large binary files, auto-downloaded
- **How to create:** Automatically downloaded on first use
- **Location:** Project root (but RAG is now on HuggingFace)

### `htmlcov/` - Test coverage reports
- **Why ignored:** Generated by pytest
- **How to create:** Run `poetry run pytest --cov=src --cov-report=html`
- **Location:** Project root

---

## üéØ Quick Checklist

Before running the app, make sure:

- [ ] Python 3.11+ installed
- [ ] Poetry installed
- [ ] PostgreSQL running
- [ ] Dependencies installed (`poetry install`)
- [ ] `.env` file created and filled in
- [ ] Database created (`createdb book_management`)
- [ ] Migrations run (`poetry run alembic upgrade head`)
- [ ] Tests passing (`poetry run pytest`)

If all checkboxes are done ‚úÖ, you're ready to go! üöÄ

---

## üÜò Still Stuck?

1. Check the main [README.md](README.md) for detailed documentation
2. Review [PROJECT_REPORT.md](PROJECT_REPORT.md) for architecture details
3. Open an issue on GitHub with:
   - What command you ran
   - The error message you got
   - Your operating system
   - Python version (`python --version`)

---

**Happy coding! üéâ**
